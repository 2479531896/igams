<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.matridx.server.wechat.dao.post.IHbqxDao" >
	<select id="getHbidByYhid" parameterType="String" resultType="String">
		select hbqx.hbid from igams_hbqx hbqx
		where hbqx.yhid=#{yhid}
	</select>
	
		<!-- 添加伙伴权限信息 -->
	<insert id="insertHbqx" parameterType="HbqxDto">
		insert into igams_hbqx(yhid,xh,hbid)
		values
			<foreach collection="ids" separator="," open="" close="" item="item" index="index">
				(#{yhid},#{index},#{item})
			</foreach>
	</insert>
	<!-- 根据yhid查询伙伴权限信息 -->
	<select id="getHbqxxx" parameterType="HbqxDto" resultType="HbqxDto">
		select hb.hbid,hb.hbmc,sf.csid sfid,sf.csmc sfmc,hbqx.hbid hbxx 
		from igams_sjhbxx hb
		left outer join igams_hbqx hbqx on hb.hbid = hbqx.hbid and hbqx.yhid=#{yhid}
		left outer join matridx_jcsj sf on sf.csid = hb.sf
		where hb.scbj!='1'
		order by sf.cspx,sf.csmc,hbmc
	</select>
	<!-- 删除用户伙伴权限信息 -->
	<delete id="delyhqxxx" parameterType="HbqxDto">
		delete from igams_hbqx
		<where>
			yhid=#{yhid}
		</where>
	</delete>
	
	<!--通过用户id获取伙伴信息 -->
	<select id="getHbxxByYhid" parameterType="String" resultType="HbqxDto">
		select hbqx.yhid,hbqx.xh,hbqx.hbid,sjhb.hbmc from igams_hbqx hbqx
		left join igams_sjhbxx sjhb on sjhb.hbid=hbqx.hbid and sjhb.scbj = '0'
		<where>
			hbqx.yhid=#{yhid}
		</where>
	</select>
</mapper>
