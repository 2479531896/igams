<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.matridx.igams.production.dao.post.IWjssdwDao" >
	<!-- 新增文件所属单位 -->
	<insert id="insert" parameterType="WjssdwDto">
		insert into igams_wjssdw(wjid
		<if test="xh != null and xh != ''">
		,xh
		</if>
		<if test="jgid != null and jgid != ''">
		,jgid
		</if>
		)
		values(#{wjid}
		<if test="xh != null and xh != ''">
		,cast(#{xh} as numeric)
		</if>
		<if test="jgid != null and jgid != ''">
		,#{jgid}
		</if>
		)
	</insert>

	<insert id="insertDtoList" parameterType="List">
		insert into igams_wjssdw(wjid,xh,jgid)
		values
		<if test="list !=null and list.size > 0">
			<foreach collection="list" separator="," item="item" index="index">
				(
				#{item.wjid},cast(#{item.xh} as numeric),#{item.jgid}
				)
			</foreach>
		</if>
	</insert>

	<!-- 根据文件id查询文件所属单位信息 -->
	<select id="getWjssdwByWjid" parameterType="WjssdwDto" resultType="WjssdwDto">
		select wjss.wjid,wjss.jgid,wjss.xh,jg.jgmc
		from igams_wjssdw wjss
		left join matridx_jgxx jg on jg.jgid=wjss.jgid
		<where>
			wjid=#{wjid}
		</where>
	</select>
	<!-- 根据文件ids删除对应文件所属单位信息 -->
	<delete id="deleteWjssdw" parameterType="WjssdwDto">
		delete from igams_wjssdw
		<where>
			wjid in
			<foreach collection="ids" open="(" close=")" separator="," item="item" index="index">
				#{item}
			</foreach>
		</where>
	</delete>
	<!-- 根据文件ID修改文件所属单位信息 -->
	<update id="updateWjssdw" parameterType="WjssdwDto">
		update igams_wjssdw
		<set>
			jgid=#{jgid}
		</set>
		<where>
			wjid=#{wjid}
		</where>
	</update>

	<select id="getListGroup" parameterType="WjssdwDto" resultType="WjssdwDto">
		SELECT
			tab.jgid,
			jg.jgmc
		FROM
			( SELECT wjss.jgid FROM igams_wjssdw wjss GROUP BY wjss.jgid ) tab
			LEFT JOIN matridx_jgxx jg ON jg.jgid = tab.jgid
	</select>
</mapper>
