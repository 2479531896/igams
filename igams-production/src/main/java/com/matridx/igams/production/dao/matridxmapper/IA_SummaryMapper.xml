<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.matridx.igams.production.dao.matridxsql.IA_SummaryDao" >
	<select id="getPriceForcInvCodes" parameterType="IA_SummaryDto" resultType="IA_SummaryDto">
		SELECT su.cInvCode,case when Sum(su.iNum)=0 then 0 else Sum(su.iMoney)/Sum(su.iNum) end  iMoney
		FROM IA_Summary su
		where su.iYear=cast(#{iYear} as numeric)
		and su.iMonth=cast(#{iMonth} as numeric)
		and su.iMoney is not null and su.iNum is not null
		<if test="cInvCodes !=null and cInvCodes.size >0" >
			and su.cInvCode in
			<foreach collection="cInvCodes" open="(" close=")" separator="," item="item">
				#{item}
			</foreach>
		</if>
		group by su.cInvCode
	</select>
</mapper>