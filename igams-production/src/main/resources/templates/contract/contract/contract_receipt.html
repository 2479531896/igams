<!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<script type="text/javascript" src="/js/systemmain/task/bootstrap-tagsinput.js" charset="utf-8"></script>
		<script type="text/javascript" src="/js/plugins/bootstrap-fileinput/fileinput.min.js" charset="utf-8"></script>
		<script type="text/javascript" src="/js/plugins/bootstrap-fileinput/zh.js" charset="utf-8"></script>
		<link rel="stylesheet" type="text/css" href="/js/plugins/bootstrap-fileinput/fileinput.min.css" />
		<link rel="stylesheet" type="text/css" href="/js/systemmain/task/bootstrap-tagsinput.css" />
		<style type="text/css">
			.bootstrap-tagsinput {
			    min-width:100%;
			}
			.label-info {
				cursor: pointer;
			}
			 .error{
             color: #a94442;
         	}
         	table{
			table-layout: fixed;
			}
			tr{
			width:100%;
			}
			.first th{
			border:1px solid #DDDDDD;
			}
			.first td{
			border:1px solid #DDDDDD;
			}
		</style>
	</head>
	<body>
	<div id="receiptbody">
	<div id = "receiptview">
		<form id="receiptForm" class="form-horizontal sl_all_form" method="post" theme="simple" data-bs-toggle="validation">
			<div class="body-content">
				<div class="row">
					<input type="hidden" name="access_token"/>
					<input type="hidden" name="czr" id="czr" th:value="${czr}"/>
					<input type="hidden" name="htid" th:value="${htglDto.htid}" id="htid"/>		
					<input type="hidden" name="formAction" th:value="${formAction}" id="formAction"/>	
					<input type="hidden" name="urlPrefix" id ="urlPrefix" th:value="${urlPrefix}">				
					<div class="col-md-4 col-sm-4">
						<div class="form-group">
							<label for="" class="col-sm-4 col-xs-4 col-md-4 control-label">
								合同金额 </label>
							<div class="col-sm-8 col-xs-8 col-md-8 padding_t7">
								<span id="zje" th:text="${htglDto.zje}" />
							</div>
						</div>
					</div>
					<div class="col-md-4 col-sm-4">
						<div class="form-group">
							<label for="" class="col-sm-4 col-xs-4 col-md-4 control-label">
								发票金额 </label>
							<div class="col-sm-8 col-xs-8 col-md-8 padding_t7">
								<span id = "fpzje" th:text="${htfpqkDto.fpzje}" />
							</div>
						</div>
					</div>
					<div class="col-md-12 col-sm-12">
						<button class='btn btn-default col-md-1 col-sm-1' type='button' id='add' name='add' onclick="editdiv()" style="margin-left:15px;margin-top:15px;margin-bottom:15px;"><span class='glyphicon glyphicon-plus'>添加</span></button>		
					</div>
					
					<!-- 发票明细table -->
					<div class="col-md-12 col-sm-12 col-xs-12 text-left">
						<table class="table table-bordered col-md-12 col-sm-12 col-xs-12" style="width:100%;">
						  <thead class="success first">
						    <tr>
						      <th style="width:7%;">序号</th>
						      <th style="width:12%;">发票号码</th>
						      <th style="width:18%;">发票种类</th>
						      <th style="width:10%;">税率</th>
						      <th style="width:12%;">接收日期</th>
						      <th style="width:10%;">发票金额</th>
						      <th style="width:15%;">转交财务日期</th>
						      <th style="width:10%;">操作人</th>
						      <th style="width:18%;">操作</th>
						    </tr>
						  </thead>
						  <tbody>
						    <tr class="tr first" th:if="${htfplist != null && htfplist.size() > 0}" th:each="list:${htfplist}">
						      <td style="width:7%;" th:text="${listStat.index+1}"></td>
						      <td th:text="${list.fphm}" style="width:12%;"></td>
						      <td th:text="${list.fpzlmc}" style="width:18%;"></td>
						      <td th:text="${list.sl}" style="width:10%;"></td>
						      <td th:text="${list.fpjsrq}" style="width:12%;"></td>
						      <td th:text="${list.fpje}" style="width:10%;"></td>
						      <td th:text="${list.zjcwrq}" style="width:10%;"></td>
						      <td th:text="${list.czr}" style="width:10%;"></td>
						      <td style="width:18%;">
						      	<div class='col-sm-12 col-md-12 '>
						      		<div class='row'>
						      			<div class='btn-group'>
						      				<button class='btn btn-default col-md-6 col-sm-6' type='button' title='合同发票编辑' th:onclick="modviewreceipt([[${list.htfpid}]])"><span class='glyphicon glyphicon-remove'>编辑</span></button>
						      				<button class='btn btn-default col-md-6 col-sm-6' type='button' title='合同发票删除' th:onclick="delreceipt([[${list.htfpid}]])"><span class='glyphicon glyphicon-pencil'>删除</span></button>
						      			</div>
						      		</div>
						      	</div>
						      </td>
						    </tr>
						  </tbody>
						</table>
					</div>
				</div>
			</div>
			</form>
			</div>
			<div id="addreceipt" style="display:none;">
			<form id="receipt_ajaxForm" class="form-horizontal sl_all_form" method="post" theme="simple" data-bs-toggle="validation">
			<input type="hidden" name="htfpid" id="htfpid" th:value="${htfpqkDto.htfpid}"/>
			<input type="hidden" name="fjids" id="fjids" th:value="${htfpqkDto.fjids}"/>
			<input type="hidden" name="access_token" id="access_token"/>
			<input type="hidden" name="ywlx" id="ywlx" th:value="${htfpqkDto.ywlx}"/>
			<input type="hidden" name="formAction" id="formAction" th:value="${htfpqkDto.formAction}"/>
			<div  class="body-content" >
				<div class="row" >
					<div class="col-md-6 col-sm-6" id="keydown">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span style="color: red;">*</span>发票号码
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="fphm" name="fphm"  onblur="smqsm()"  validate="{required:true}" class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span style="color: red;">*</span>税率
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="sl" name="sl" th:value="${gyssl} " validate="{required:true}" class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span style="color: red;">*</span>发票金额
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="fpje" name="fpje" onblur="jsbhsje()"  validate="{required:true}" class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span style="color: red;">*</span>发票接收日期
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="fpjsrq" name="fpjsrq"  validate="{required:true}" class="form-control" />
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span></span>转交财务日期
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="zjcwrq" name="zjcwrq"  class="form-control" />
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									<span style="color: red;">*</span>发票种类
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6" th:if="${fpzllist !=null && fpzllist.size() > 0}"> 
									<select id="fpzl" name="fpzl" th:value="${htfpqkDto.fpzlmc}" class="form-control chosen-select" style="height:34px;" validate="{required:true}">
										<option value="" id="qxz">--请选择--</option>
	                        			<option class="selectlist" th:id="${list.csid}" th:each="list:${fpzllist}" th:value="${list.csdm}" th:text="${list.csdm}+'--'+${list.csmc}" th:cskz1="${list.cskz1}" th:csdm="${list.csdm}" ></option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									不含税金额
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="bhsje" name="bhsje"  class="form-control" onblur="jsFpje()"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									开票日期
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="kprq" name="kprq"  class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									发票代码
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="fpdm" name="fpdm"  class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="col-md-12 col-sm-12">
							<div class="form-group">
								<label for="" class="col-sm-4 col-md-4 col-xs-4 control-label">
									操作人
								</label>
								<div class="col-sm-6 col-xs-6 col-md-6">
									<input type="text" id="czr" name="czr"  readonly="true" class="form-control"/>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-12 col-sm-12">
						<div id="fjnr" class="form-group">

						</div>
					</div>
					<div class="col-md-12 col-sm-12">
						<div class="form-group">
							<label for="" class="col-sm-2 col-xs-2 col-md-2 control-label">
								附件上传：
							</label>
							<div class="col-sm-10 col-xs-10 col-md-10" style="line-height:28px;">
								<a href="javascript:void(0);" onclick="ContractFpeditfile()" id="contractFile_btn" style="display:inline-block;width:100%;;border:1px solid #CCCCCC;border-radius:3px;">
									<span  id="fileclick" title="点击上传"  style="display:inline-block;width:100%;color:#A6A6A6;font-size:12px;padding-left:10px;">点击展开上传文件</span>
								</a>
								<div id="contractFileDiv" style="display:none;">
									<input id="pro_file" name="pro_file" type="file">
									<button class="btn btn-default" type="button" style="margin-left:77%;width:23%;margin-top:10px;" onclick="ContractFpcancelfile()">隐藏</button>
								</div>
							</div>
						</div>
					</div>

					<!-- 合同明细table -->
					<div class="col-md-12 col-sm-12 col-xs-12 text-left">
						<table id="htmx_list"
							   class="table table-hover table-bordered table-hidden"
							   data-reorderable-columns="true"></table>
					</div>
					<div class="col-md-12 col-sm-12" style="margin-top:10px;">
						<div class="col-md-3 col-sm-3"></div>
						<div class="col-md-6 col-sm-6">
							<div class="form-group" style="padding-right: 19px;">
							<div class="col-md-2 col-sm-2"></div>
							<button title="确定" class="btn btn-success col-md-2 col-sm-2" type="button" onclick="ContractInsertreceipt()">
	    						<span>确定</span>
	    					</button>
	    					<div class="col-md-4 col-sm-4"></div>
							<button title="取消" class="btn btn-danger col-md-2 col-sm-2" type="button" onclick="ContractReturnview()">
	    						<span>取消</span>
	    					</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
	</div>
	</body>
	<script type="text/javascript" th:src="@{${urlPrefix} + '/js/contract/contract/contract_receipt.js'}" charset="utf-8"></script>
</html>