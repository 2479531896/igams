(function(a){a.bootui=a.bootui||{};a.bootui.widget=a.bootui.widget||{};a.bootui.widget.FileWrap=function(c,b){b.beforeRender.call(this,c);this.initialize.call(this,c,b);b.afterRender.call(this,c)};a.bootui.widget.FileWrap.prototype={constructor:a.bootui.widget.FileWrap,initialize:function(e,j){var g=this;this.$element=a(e);this.options=j;if(!a(e).is(":file")){throw new Error(" Current Element is not a file input ! ")}else{if(a.browser.msie===true&&a.browser.version<9){return}g.initializedFlag=true;var b=a(j.template);var d=a(b).find(".file-input");var h=j.placeholder||a(e).attr("placeholder")||a(e).attr("title")||"\u6d4f\u89c8...";a(d).append("<label>"+h+"</label>");a(b).css({width:j.width||a(e).parent().innerWidth(),height:j.height||a(e).parent().innerHeight()});var i=a(b).find("p.tips");if(j.message&&a.trim(j.message).length>0){a(i).append((a.isFunction(j.message)?j.message.call(this):j.message.toString()))}var c=a.fn.filewrap.messages;var f=a(e).clone(true,true);a(f).change(function(l){a(i).removeClass("error");var k=a(l.target).getFiles()||l.dataTransfer.files;a.filehandle(k,{fileType:j.fileType||"*.*",maxSize:j.maxSize,maxTotal:j.maxTotal,maxCount:j.maxCount,handleInvalidType:function(m,n){a(i).empty().append(n).addClass("error");a(f).clearFile()},handleOverMaxCount:function(m){a(i).empty().append(m).addClass("error");a(f).clearFile()},handleOverTotal:function(m){a(i).empty().append(m).addClass("error");a(f).clearFile()},handleOverSize:function(m,n){a(i).empty().append(n).addClass("error");a(f).clearFile()},handleFile:function(n,o,m){a(i).empty().append(o)}})});a(d).append(f);a(e).replaceWith(b)}},initialized:function(){return this.initializedFlag==true},setDefaults:function(b){a.extend(a.fn.filewrap.defaults,b)},getDefaults:function(){return a.fn.filewrap.defaults}};a.fn.filewrap=function(d){if(typeof d=="string"){var f=a(this[0]),e=f.data("filewrap");if(!e&&d=="destroy"){return}if(e){var c=a.grep(arguments||[],function(h,g){return g>=1});var b=e[d].apply(e,[].concat(c||[]));return(typeof b!="undefined")?b:f}}else{return this.each(function(){var i=a(this),h=i.data("filewrap");if(!h){var g=a.extend(true,{},a.fn.filewrap.defaults,i.data(),((typeof d=="object"&&d)?d:{}));i.data("filewrap",(h=new a.bootui.widget.FileWrap(this,g)))}})}};a.fn.filewrap.defaults={version:"1.0.0",beforeRender:a.noop,errorRender:a.noop,afterRender:a.noop,width:null,height:"80px",placeholder:"\u6d4f\u89c8...",message:null,fileType:"*.*",maxSize:"10M",maxTotal:"100MB",maxCount:30,template:'<div class="filewrap"><div class="placeholder"><div class="wrap"><div class="file-input"></div><p class="tips"></p></div></div></div>'};a.fn.filewrap.Constructor=a.bootui.widget.FileWrap;a(document).off("wrap.filewrap.widget.data-api",'[data-widget*="filewrap"]').on("wrap.filewrap.widget.data-api",'[data-widget*="filewrap"]',function(b){if(b.currentTarget=this){if(a(this).is(":file")){a(this).filewrap()}}})}(jQuery));
